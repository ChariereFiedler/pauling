{% extends "layout.html" %}

{% block content %}
<section class="steps-wrapper">
    <div class="content-wrapper">
        <div class="steps">
            <div class="steps-list">
                <h4><strike>1. Paste the link to your poster on F1000, Figshare, etc.</strike></h4>
                <h4><strike>2. Verify the information below and generate your QR code</strike></h4>
                <h4>3. Add the QR code to your poster and print it</h4>

                <progress class="progress is-primary" value="100" max="100">100%</progress>
            </div>
        </div>
    </div>
</section>

<section class="publish-poster">
    <div class="content-wrapper">
        <div class="column is-two-thirds content">
            <h1>Congratulations!</h1>

            <p>You will find your QR code below:</p>

            <div class="columns">
                <div class="column">
                    <div class="card">
                        <div class="card-content">
                            <img class="qrcode" src="{{ url_for('poster_qrcode_svg', id=poster.id) }}">
                        </div>
                        <footer class="card-footer">
                            <a class="card-footer-item" href="{{ url_for('poster_qrcode_svg', id=poster.id) }}">Download as SVG</a>
                        </footer>
                    </div>
                </div>
                <div class="column">
                    <div class="card">
                        <div class="card-content">
                            <img class="qrcode" src="{{ url_for('poster_qrcode_png', id=poster.id) }}">
                        </div>
                        <footer class="card-footer">
                            <a class="card-footer-item" href="{{ url_for('poster_qrcode_png', id=poster.id) }}">Download as PNG</a>
                        </footer>
                    </div>
                </div>
            </div>

            <p>
                A "home" for your poster has been created and you can view it
                <a href="{{ url_for('get_poster', id=poster.id) }}">here</a>.
                The URL to this page (below) is public and permanent. Feel free
                to share it with everyone:
            </p>

            <div class="field has-addons">
                <div class="control is-expanded">
                    <input id="public-url" class="input" type="text" value="{{ url_for('get_poster', id=poster.id, _external=True) }}">
                </div>
                <div class="control">
                    <button class="button clipboard" data-clipboard-target="#public-url">
                        <i class="fa fa-clipboard"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="content-wrapper">
        <div class="column is-two-thirds content">
            <h3>Admin area</h3>
            <p>
                You can edit the information for this poster at any time
                <a href="{{ url_for('edit_poster', id_admin=poster.id_admin) }}">here</a>.
            </p>
        </div>
    </div>
</section>

<section class="section">
    <div class="content-wrapper">
        <div class="column is-two-thirds content">
            {% if not poster.email %}
            <h3>One more thing</h3>
            <p>
                Enter your email below to receive these information by email. <strong>No spam, ever.</strong>
            </p>
            <form method="POST">
                {{ form.csrf_token }}

                <div class="field has-addons">
                    <div class="control has-icons-left">
                        <input name="email" class="input is-medium" type="email" placeholder="Enter your email here">
                        <span class="icon is-left">
                            <i class="fa fa-envelope"></i>
                        </span>
                        {% for error in form.email.errors %}
                        <p class="help is-danger">{{ error }}</p>
                        {% endfor %}
                    </div>
                    <div class="control">
                        <button class="button is-medium {% if form.email.errors %}is-danger{% else %}is-primary{% endif %}">
                            Submit
                        </button>
                    </div>
                </div>
            </form>
            {% else %}
            <h3>Notifications</h3>
            You should receive emails at: <code>{{ poster.email }}</code>.
            Wrong email? Please <a href="mailto:support@tailordev.fr">contact us</a>.
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='js/clipboard.min.js') }}"></script>
<script>
    var clipboard = new Clipboard('.clipboard');
    clipboard.on('success', function (e) {
        alert('Copied!');
    });
</script>
{% endblock %}
